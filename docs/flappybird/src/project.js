window.__require=function t(e,i,r){function a(s,o){if(!i[s]){if(!e[s]){var n=s.split("/");if(n=n[n.length-1],!e[n]){var h="function"==typeof __require&&__require;if(!o&&h)return h(n,!0);if(l)return l(n,!0);throw new Error("Cannot find module '"+s+"'")}}var d=i[s]={exports:{}};e[s][0].call(d.exports,function(t){return a(e[s][1][t]||t)},d,d.exports,t,e,i,r)}return i[s].exports}for(var l="function"==typeof __require&&__require,s=0;s<r.length;s++)a(r[s]);return a}({BirdCollision:[function(t,e,i){"use strict";cc._RF.push(e,"480d61GWTdMMaFhZexSRiJO","BirdCollision"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){cc.director.getCollisionManager().enabled=!0},onCollisionEnter:function(t,e){"Pillar"==t.node.group&&this.node.dispatchEvent(new cc.Event.EventCustom("collided",!0))},onCollisionExit:function(t,e){"ScoreSpace"==t.node.group&&this.node.dispatchEvent(new cc.Event.EventCustom("score",!0))}}),cc._RF.pop()},{}],PillarGenerator:[function(t,e,i){"use strict";cc._RF.push(e,"fec57h7ZKBEWbtIDVOxFXA9","PillarGenerator"),cc.Class({extends:cc.Component,properties:{pillarPrefab:{default:null,type:cc.Prefab,tooltip:"\u67f1\u5b50\u969c\u788d\u7269\u7684 Prefab"},scroreSpacePrefab:{default:null,type:cc.Prefab,tooltip:"\u67f1\u5b50\u969c\u788d\u7269\u4e2d\u95f4\u7684\u7a7a\u9699 prefab"},scoreLabel:{default:null,type:cc.Label,tooltip:"\u663e\u793a\u5206\u6570\u7684 label \u7ec4\u4ef6"},score:{default:0,visible:!1,tooltip:"\u73a9\u5bb6\u5206\u6570"},pillarSapce:{default:0,tooltip:"\u4e0a\u4e0b\u969c\u788d\u7269\u7684\u4e2d\u95f4\u7a7a\u9699\u95f4\u8ddd"},pillarMinHeight:{default:0,tooltip:"\u4e0a\u4e0b\u9884\u7559\u7ed9\u969c\u788d\u7269\u7684\u6700\u5c0f\u9ad8\u5ea6"},pillarMoveSpeed:{default:0,tooltip:"\u969c\u788d\u7269\u7684\u79fb\u52a8\u901f\u5ea6"},pillarGenerateMargin:{default:0,tooltip:"\u95f4\u9694\u591a\u8fdc\u751f\u6210\u4e00\u6b21\u969c\u788d\u7269"},pillars:{default:[],visible:!1,tooltip:"\u8bb0\u5f55\u6240\u6709\u969c\u788d\u7269\u7684\u6570\u7ec4"},lastPillarGenerateMargin:{default:0,visible:!1,tooltip:"\u8ddd\u79bb\u4e0a\u4e00\u6b21\u751f\u6210\u969c\u788d\u7269\u95f4\u9694\u4e86\u591a\u8fdc\u4e86"},birdPrefab:{default:null,type:cc.Prefab,tooltip:"\u5c0f\u9e1f\u7684 Prefab"},bird:{default:null,visible:!1,tooltip:"\u8fd0\u884c\u65f6\u751f\u6210\u7684\uff0c\u5f53\u524d\u5728\u753b\u9762\u4e2d\u7684\u9e1f"},birdUpSpeed:{default:0,tooltip:"\u70b9\u51fb\u5c4f\u5e55\u65f6\uff0c\u9e1f\u83b7\u5f97\u7684\u4e0a\u5347\u901f\u5ea6"},birdSpeed:{default:0,visible:!1,tooltip:"\u9e1f\u5f53\u524d\u5728 y \u65b9\u5411\u4e0a\u7684\u901f\u5ea6"},birdGravitationalAcceleration:{default:0,tooltip:"\u9e1f\u4e0b\u964d\u7684\u91cd\u529b\u52a0\u901f\u5ea6"},isCollided:{default:!1,visible:!1,tooltip:"\u662f\u5426\u53d1\u751f\u4e86\u78b0\u649e"},startLayer:{default:null,type:cc.Node,tooltip:"\u5f00\u59cb\u6e38\u620f\u89c6\u56fe"}},onLoad:function(){console.log("update to 2.1 by yangyang"),this.setupEventListener(),this.setupCollisionListener(this),this.setupStartLayer(),this.setupBird(),this.setupPillars(),this.showStartLayer()},update:function(t){if(!this.isCollided){for(var e=t*this.pillarMoveSpeed,i=0;i<this.pillars.length;i++){var r=this.pillars[i],a=r[0],l=r[1],s=r[2];a.x-=e,l.x-=e,s.x-=e}if(this.lastPillarGenerateMargin+=e,this.lastPillarGenerateMargin>=this.pillarGenerateMargin){var o=this.node.width/2+this.pillars[0][0].width/2;this.generateTwoPillar(o),this.lastPillarGenerateMargin=0}for(var n=0;n<this.pillars.length;n++){var h=this.pillars[n],d=h[0],p=h[1],c=h[2],u=-this.node.width/2-d.width/2;d.x<u&&(this.pillars.shift(),d.removeFromParent(),p.removeFromParent(),c.removeFromParent())}var f=this.birdSpeed-this.birdGravitationalAcceleration*t;this.birdSpeed=f;var b=t*this.birdSpeed;this.bird.angle=f/this.birdUpSpeed*-20;var v=this.bird.y+b;this.bird.y=v}},setupStartLayer:function(){this.startLayer.removeFromParent()},showStartLayer:function(){this.isCollided=!0,this.startLayer.removeFromParent();var t=this.node.parent;t.addChild(this.startLayer),this.startLayer.width=t.width,this.startLayer.height=t.height,this.startLayer.x=0,this.startLayer.y=0},setupPillars:function(){var t=cc.instantiate(this.pillarPrefab),e=this.node.width/2+t.width/2;this.generateTwoPillar(e),this.lastPillarGenerateMargin=0},restartGame:function(){for(var t=0;t<this.pillars.length;t++){var e=this.pillars[t],i=e[0],r=e[1],a=e[2];i.removeFromParent(),r.removeFromParent(),a.removeFromParent()}this.pillars=[],this.bird.removeFromParent(),this.score=0,this.scoreLabel.string=this.score.toString(),this.setupPillars(),this.setupBird(),this.startLayer.removeFromParent(),this.isCollided=!1},generateTwoPillar:function(t){var e=cc.instantiate(this.pillarPrefab).width,i=this.node.height-2*this.pillarMinHeight-this.pillarSapce,r=Math.random()*i-i/2,a=r+this.pillarSapce/2,l=this.node.height/2-a,s=a+l/2,o=this.generateAPillar(t,s,e,l,0),n=r-this.pillarSapce/2,h=this.node.height/2+a,d=n-h/2,p=this.generateAPillar(t,d,e,h,180),c=cc.instantiate(this.scroreSpacePrefab);this.node.addChild(c),c.width=e,c.height=a-n,c.x=t,c.y=n+c.height/2;var u=c.getComponent(cc.BoxCollider);u.size.width=c.width,u.size.height=c.height,u.offset.x=0,u.offset.y=0,this.pillars.push([o,p,c])},generateAPillar:function(t,e,i,r,a){var l=cc.instantiate(this.pillarPrefab);this.node.addChild(l),l.angle=a,l.width=i,l.height=r,l.x=t,l.y=e;var s=l.getComponent(cc.BoxCollider);return s.size.width=l.width,s.size.height=l.height,s.offset.x=0,s.offset.y=0,l},setupBird:function(){this.bird=cc.instantiate(this.birdPrefab);this.bird.x=-200,this.bird.y=0,this.node.addChild(this.bird),this.birdSpeed=this.birdUpSpeed},setupEventListener:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(t){this.startLayer.parent?this.restartGame():(this.birdSpeed=this.birdUpSpeed,this.bird.angle=-20)},this)},setupCollisionListener:function(){var t=this;this.node.on("collided",function(e){var i=t.getComponent("PillarGenerator");i.isCollided=!0,i.showStartLayer()}),this.node.on("score",function(e){var i=t.getComponent("PillarGenerator");i.score++,i.scoreLabel.string=i.score.toString()})}}),cc._RF.pop()},{}]},{},["BirdCollision","PillarGenerator"]);